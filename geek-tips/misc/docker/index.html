
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Docker &#8212; NeuroPoly Lab Manual</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="shortcut icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">NeuroPoly Lab Manual</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right"><a href="https://github.com/neuropoly/intranet.neuro.polymtl.ca/edit/master/geek-tips/misc/docker/README.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>

</a>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Page Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#docker-terminology">
   Docker Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-docker">
   Using Docker
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#search-for-remote-image">
     Search for remote image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-run-linux-distribution-a-id-install-run-linux-distribution-a">
     Install &amp; Run Linux distribution
     <a id="install_run_linux_distribution">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-local-docker-images-a-id-list-local-docker-images-a">
     List local Docker images
     <a id="list_local_docker_images">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-docker-image-a-id-run-docker-image-a">
     Run Docker image
     <a id="run_docker_image">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-docker-image-or-containers-force-deletion-a-id-remove-docker-image-or-containers-force-deletion-a">
     Remove Docker image or containers (force deletion)
     <a id="remove_docker_image_or_containers_force_deletion">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-a-docker-image-a-id-save-a-docker-image-a">
     Save a Docker image
     <a id="save_a_docker_image">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-docker-container-from-dockerfile-a-id-build-docker-container-from-dockerfile-a">
     Build Docker container from Dockerfile
     <a id="build_docker_container_from_dockerfile">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-with-display-redirection-a-id-run-with-display-redirection-a">
     Run with DISPLAY redirection
     <a id="run_with_display_redirection">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#copy-file-into-container-a-id-copy-file-into-container-a">
     Copy file into container
     <a id="copy_file_into_container">
     </a>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Docker</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Page Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#docker-terminology">
   Docker Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-docker">
   Using Docker
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#search-for-remote-image">
     Search for remote image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-run-linux-distribution-a-id-install-run-linux-distribution-a">
     Install &amp; Run Linux distribution
     <a id="install_run_linux_distribution">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-local-docker-images-a-id-list-local-docker-images-a">
     List local Docker images
     <a id="list_local_docker_images">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-docker-image-a-id-run-docker-image-a">
     Run Docker image
     <a id="run_docker_image">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-docker-image-or-containers-force-deletion-a-id-remove-docker-image-or-containers-force-deletion-a">
     Remove Docker image or containers (force deletion)
     <a id="remove_docker_image_or_containers_force_deletion">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-a-docker-image-a-id-save-a-docker-image-a">
     Save a Docker image
     <a id="save_a_docker_image">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-docker-container-from-dockerfile-a-id-build-docker-container-from-dockerfile-a">
     Build Docker container from Dockerfile
     <a id="build_docker_container_from_dockerfile">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-with-display-redirection-a-id-run-with-display-redirection-a">
     Run with DISPLAY redirection
     <a id="run_with_display_redirection">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#copy-file-into-container-a-id-copy-file-into-container-a">
     Copy file into container
     <a id="copy_file_into_container">
     </a>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="docker">
<h1>Docker<a class="headerlink" href="#docker" title="Permalink to this headline">#</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="docker-terminology">
<h2>Docker Terminology<a class="headerlink" href="#docker-terminology" title="Permalink to this headline">#</a></h2>
<p><strong>Images</strong> - The blueprints of our application which form the basis of containers.</p>
<p><strong>Containers</strong> - Created from Docker images and run the actual application. A list of running containers can be seen using the docker ps command. <strong>Docker Daemon</strong> - The background service running on the host that manages building, running and distributing Docker containers. The daemon is the process that runs in the operating system to which clients talk to.</p>
<p><strong>Docker Client</strong> - The command line tool that allows the user to interact with the daemon.</p>
<p><strong>Docker Hub</strong> - A registry of Docker images. You can think of the registry as a directory of all available Docker images. If required, one can host their own Docker registries and can use them for pulling images.</p>
</section>
<section id="using-docker">
<h2>Using Docker<a class="headerlink" href="#using-docker" title="Permalink to this headline">#</a></h2>
<section id="search-for-remote-image">
<h3>Search for remote image<a class="headerlink" href="#search-for-remote-image" title="Permalink to this headline">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>docker search ubuntu  # will search for ubuntu distrib
</pre></div>
</div>
<p><a class="reference external" href="https://hub.docker.com/_/ubuntu">List of Ubuntu images</a></p>
</section>
<section id="install-run-linux-distribution-a-id-install-run-linux-distribution-a">
<h3>Install &amp; Run Linux distribution <a id="install_run_linux_distribution"></a><a class="headerlink" href="#install-run-linux-distribution-a-id-install-run-linux-distribution-a" title="Permalink to this headline">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>docker pull debian  # will install debian
docker pull ubuntu:16.04
docker pull centos
</pre></div>
</div>
</section>
<section id="list-local-docker-images-a-id-list-local-docker-images-a">
<h3>List local Docker images <a id="list_local_docker_images"></a><a class="headerlink" href="#list-local-docker-images-a-id-list-local-docker-images-a" title="Permalink to this headline">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>docker images
</pre></div>
</div>
</section>
<section id="run-docker-image-a-id-run-docker-image-a">
<h3>Run Docker image <a id="run_docker_image"></a><a class="headerlink" href="#run-docker-image-a-id-run-docker-image-a" title="Permalink to this headline">#</a></h3>
<p>To run in interactive mode, use flag <code class="docutils literal notranslate"><span class="pre">-i</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run -it IMAGE /bin/bash
docker run -it ubuntu:trusty /bin/bash
docker run -it ubuntu:16.04
</pre></div>
</div>
</section>
<section id="remove-docker-image-or-containers-force-deletion-a-id-remove-docker-image-or-containers-force-deletion-a">
<h3>Remove Docker image or containers (force deletion) <a id="remove_docker_image_or_containers_force_deletion"></a><a class="headerlink" href="#remove-docker-image-or-containers-force-deletion-a-id-remove-docker-image-or-containers-force-deletion-a" title="Permalink to this headline">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>docker rmi -f IMAGE_ID
docker rmi $(docker images -a -q)  # WARNING!!! This will remove all images
docker rm $(docker ps -a -f status=exited -q)  # WARNING!!! This will remove all containers
</pre></div>
</div>
</section>
<section id="save-a-docker-image-a-id-save-a-docker-image-a">
<h3>Save a Docker image <a id="save_a_docker_image"></a><a class="headerlink" href="#save-a-docker-image-a-id-save-a-docker-image-a" title="Permalink to this headline">#</a></h3>
<p>The example below shows how to install useful items on a standard ubuntu image, and then save the image locally.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># launch docker
docker pull ubuntu:16.04
docker run ubuntu:16.04
# inside image
apt-get update
yes | apt install git curl bzip2
# open another Terminal
# list current docker images
docker ps -a
# save container as new image
docker commit &lt;container_id&gt; your_name/ubuntu:16.04
</pre></div>
</div>
</section>
<section id="build-docker-container-from-dockerfile-a-id-build-docker-container-from-dockerfile-a">
<h3>Build Docker container from Dockerfile <a id="build_docker_container_from_dockerfile"></a><a class="headerlink" href="#build-docker-container-from-dockerfile-a-id-build-docker-container-from-dockerfile-a" title="Permalink to this headline">#</a></h3>
<ol class="arabic simple">
<li><p>Create a Dockerfile by running `touch Dockerfile`</p></li>
<li><p>Inside the Dockerfile write the following (items below are just given as an example):</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">FROM centos:latest</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>RUN yum -y update \
&amp;&amp; yum -y install git bzip2 gcc wget which mesa-libGL unzip \
&amp;&amp; yum clean all 
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Fetch SCT from source and install (at root directory)
RUN git clone https://github.com/neuropoly/spinalcordtoolbox.git sct; \
  cd sct; \
  yes | ./install_sct
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Add SCT executable to the system env 
ENV PATH &quot;/sct/bin:${PATH}&quot;
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Build docker image: `docker build -t &lt;container_id&gt; .`</p></li>
<li><p>Run it: `docker run -it &lt;container_id&gt;`</p></li>
</ol>
</section>
<section id="run-with-display-redirection-a-id-run-with-display-redirection-a">
<h3>Run with DISPLAY redirection <a id="run_with_display_redirection"></a><a class="headerlink" href="#run-with-display-redirection-a-id-run-with-display-redirection-a" title="Permalink to this headline">#</a></h3>
<p>In order to run scripts with GUI you need to allow X11 redirection:</p>
<ol class="arabic simple">
<li><p>Install XQuartz X11 server and run it.</p></li>
<li><p>In preferences, check ‘Allow connections from network clientsoption inXQuartz` settings.</p></li>
<li><p>Quit and restart XQuartz.</p></li>
<li><p>In XQuartz window xhost + 127.0.0.1</p></li>
<li><p>In your other Terminal window, run:</p>
<ol class="arabic simple">
<li><p>On OSX: `docker run -e DISPLAY=host.docker.internal:0 -it &lt;CONTAINER_ID&gt;`</p></li>
<li><p>On Linux: `docker run -ti –rm -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix &lt;CONTAINER_ID&gt;`</p></li>
</ol>
</li>
</ol>
</section>
<section id="copy-file-into-container-a-id-copy-file-into-container-a">
<h3>Copy file into container <a id="copy_file_into_container"></a><a class="headerlink" href="#copy-file-into-container-a-id-copy-file-into-container-a" title="Permalink to this headline">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># list container</span>
docker ps
<span class="c1"># copy file</span>
docker cp &lt;file&gt; &lt;CONTAINER ID&gt;:&lt;PATH_DEST&gt;/&lt;file&gt;
</pre></div>
</div>
<p>Examples of Docker builder:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/neuropoly/docker">https://github.com/neuropoly/docker</a></p></li>
</ol>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By NeuroPoly<br/>
  
      &copy; Copyright 2021, NeuroPoly.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>